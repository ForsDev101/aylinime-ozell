<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Final Pixel Animasyon</title>
<style>
html, body { margin:0; padding:0; overflow:hidden; background:#f8d1dc; font-family:sans-serif;}
#container { position:relative; width:100vw; height:100vh;}
canvas { display:block; }
.overlay-text {
  position:absolute; width:100%; text-align:center;
  top:40%; font-size:2em; color:white;
  text-shadow:2px 2px 10px rgba(0,0,0,0.6);
  perspective:1000px; transform-style:preserve-3d;
  opacity:1; transition: opacity 0.5s;
}
</style>
</head>
<body>
<div id="container">
  <div id="text" class="overlay-text">Kalbe tÄ±klamak ister misin?</div>
  <canvas id="canvas"></canvas>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.14.0/gsap.min.js"></script>
<script>
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let stage=0;
let particles=[];
let heartSize=60;
let doorSize={w:150,h:250};
let doorPos={x:canvas.width/2, y:canvas.height/2};
let lotusDrawn=false;

// Particle class (her piksel ayrÄ±)
class Particle{
  constructor(x,y,color,targetX,targetY){
    this.x=x; this.y=y;
    this.origX=x; this.origY=y;
    this.targetX=targetX||x; this.targetY=targetY||y;
    this.vx=Math.random()*10-5; this.vy=Math.random()*10-5;
    this.color=color;
  }
  update(){
    if(stage===1){ this.x+=this.vx; this.y+=this.vy; }
    else if(stage>=2){
      this.x+=(this.targetX-this.x)*0.08;
      this.y+=(this.targetY-this.y)*0.08;
    }
  }
  draw(ctx){ ctx.fillStyle=this.color; ctx.fillRect(this.x,this.y,4,4);}
}

// Kalp piksellerini oluÅŸtur
function createHeartParticles(){
  particles=[];
  for(let y=-heartSize; y<=heartSize; y+=4){
    for(let x=-heartSize; x<=heartSize; x+=4){
      let nx = x/(heartSize), ny=y/(heartSize);
      if((nx*nx + ny*ny - 0.3)*(nx*nx + ny*ny - 0.3)*(nx*nx + ny*ny - 0.3) - nx*nx*ny*ny*ny <=0){
        particles.push(new Particle(canvas.width/2+x, canvas.height/2+y,'#ff6fa2'));
      }
    }
  }
}

// KapÄ± piksellerini oluÅŸtur
function createDoorParticles(){
  particles=[];
  for(let y=-doorSize.h/2; y<=doorSize.h/2; y+=4){
    for(let x=-doorSize.w/2; x<=doorSize.w/2; x+=4){
      if(x===-doorSize.w/2 || x===doorSize.w/2 || y===-doorSize.h/2 || y===doorSize.h/2){
        let px=doorPos.x+x; let py=doorPos.y+y;
        particles.push(new Particle(canvas.width/2,canvas.height/2,'#fff',px,py));
      }
    }
  }
}

// Lotus pikselleri
function createLotusParticles(){
  particles=[];
  let cx=canvas.width/2, cy=canvas.height/2;
  for(let i=0;i<12;i++){
    for(let r=0;r<60;r+=4){
      let angle=i*Math.PI/6;
      let px=cx+r*Math.cos(angle), py=cy+r*Math.sin(angle);
      particles.push(new Particle(canvas.width/2,canvas.height/2,'#fff',px,py));
    }
  }
}

// Animate loop
function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>{ p.update(); p.draw(ctx); });
  requestAnimationFrame(animate);
}
animate();

// BaÅŸlangÄ±Ã§ kalp
createHeartParticles();

// Click handler
canvas.addEventListener('click',()=>{
  if(stage===0){
    stage=1;
    document.getElementById('text').style.opacity=0;
    setTimeout(()=>{
      stage=2;
      createDoorParticles();
      document.getElementById('text').innerText="KapÄ± Ã§alÄ±yor bitanem, aÃ§mÄ±cak mÄ±sÄ±n?";
      document.getElementById('text').style.opacity=1;
    },800);
  }else if(stage===2){
    stage=3;
    document.getElementById('text').style.opacity=0;
    setTimeout(()=>{
      document.getElementById('text').innerText="ðŸ˜Š";
      document.getElementById('text').style.opacity=1;
      setTimeout(()=>{
        document.getElementById('text').style.opacity=0;
        setTimeout(()=>{
          document.getElementById('text').innerText="Aylin HanÄ±m deÄŸil mi? Size bir paket var.";
          document.getElementById('text').style.opacity=1;
          setTimeout(()=>{
            document.getElementById('text').style.opacity=0;
            setTimeout(()=>{
              document.getElementById('text').innerText="E hadi tÄ±klasana kutuya.";
              document.getElementById('text').style.opacity=1;
              setTimeout(()=>{
                document.getElementById('text').style.opacity=0;
                stage=4;
                lotusDrawn=true;
                createLotusParticles();
                document.getElementById('text').innerText="Bu Ã§iÃ§ek senin iÃ§in bitanem";
                document.getElementById('text').style.opacity=1;
                setTimeout(()=>{
                  particles=[];
                  for(let i=0;i<500;i++) particles.push(new Particle(canvas.width/2,canvas.height/2,'#fff'));
                },3000);
              },1000);
            },1000);
          },1000);
        },500);
      },500);
    },500);
  }
});
</script>
</body>
</html>
